<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Résultat de Prédiction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="logo">
                <h2>Score<span>Predict</span></h2>
            </div>
            <ul class="nav">
                <li><a href="/"><i class="fas fa-home"></i> Accueil</a></li>
                <li><a href="/history"><i class="fas fa-history"></i> Historique</a></li>
                <li><a href="/about"><i class="fas fa-info-circle"></i> À propos</a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <header>
                <div class="header-content">
                    <h1>Résultat de la Prédiction</h1>
                    <p>Voici le résultat prédit basé sur vos données</p>
                </div>
            </header>

            <div class="result-container">
                <div class="result-card">
                    <div class="card-header">
                        <h2><i class="fas fa-chart-bar"></i> Votre Résultat Prédit</h2>
                    </div>
                    
                    <div class="prediction-result">
                        <div class="score-display">
                            <div class="score-circle">
                                <span class="score-value">{{ prediction }}</span>
                            </div>
                        </div>
                        
                        <div class="score-details">
                            <div class="detail-item">
                                <span class="detail-label">ID du Concours:</span>
                                <span class="detail-value">{{ input_data.id_concours }}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Moyenne du Bac:</span>
                                <span class="detail-value">{{ input_data.moy_bac_et }}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Résultat Précédent:</span>
{#                                <span class="detail-value">{{ input_data.resultat }}</span>#}
                            </div>
                        </div>
                    </div>
                    
                    <div class="interpretation">
                        <h3>Interprétation du Résultat</h3>
                        {% if input_data['resultat'] == "ADMIS(E)" %}
                            <p class="excellent">Excellent! Vous êtes prédit comme étant ADMIS(E).</p>
                        {% elif input_data['resultat'] == "LISTE ATTENTE" %}
                            <p class="average">Vous êtes prédit d'être en LISTE D'ATTENTE. Il y a encore des chances d'être admis.</p>
                        {% else %}
                            <p class="below-average">Vous êtes prédit comme étant REFUSE(E). Nous vous recommandons de consulter un conseiller pédagogique.</p>
                        {% endif %}
                    </div>
                    
                    <div class="action-buttons">
                        <a href="/" class="btn-primary"><i class="fas fa-redo"></i> Nouvelle Prédiction</a>
                        <button id="save-result" class="btn-secondary"><i class="fas fa-save"></i> Sauvegarder le Résultat</button>
                    </div>
                </div>
                
                <div class="recommendation-card">
                    <div class="card-header">
                        <h2><i class="fas fa-lightbulb"></i> Recommandations</h2>
                    </div>
                    
                    <div class="recommendations">
                        <ul>
                            {% if input_data['resultat'] == "ADMIS(E)" %}
                                <li>Continuez avec votre méthode d'étude actuelle</li>
                                <li>Préparez-vous pour les prochaines étapes administratives</li>
                                <li>Commencez à explorer le logement et autres aspects pratiques</li>
                            {% elif input_data['resultat'] == "LISTE ATTENTE" %}
                                <li>Restez attentif aux communications officielles</li>
                                <li>Préparez un dossier complémentaire pour renforcer votre candidature</li>
                                <li>Envisagez des alternatives au cas où</li>
                            {% else %}
                                <li>Prenez rendez-vous avec un conseiller pédagogique</li>
                                <li>Identifiez les points à améliorer dans votre dossier</li>
                                <li>Considérez d'autres options d'établissements ou de parcours</li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 ScorePredict. Tous droits réservés.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Save result functionality
            const saveResultButton = document.getElementById('save-result');
            if (saveResultButton) {
                saveResultButton.addEventListener('click', function() {
                    // Get the prediction value from the page
                    const predictionValue = document.querySelector('.score-value').textContent.trim();
                    
                    // Get input data from the detail items
                    const idConcours = document.querySelector('.detail-item:nth-child(1) .detail-value').textContent.trim();
                    const moyBacEt = document.querySelector('.detail-item:nth-child(2) .detail-value').textContent.trim();
                    const resultat = document.querySelector('.detail-item:nth-child(3) .detail-value').textContent.trim();
                    
                    // Create prediction object
                    const prediction = {
                        id_concours: idConcours,
                        moy_bac_et: moyBacEt,
                        resultat: resultat,
                        prediction: predictionValue,
                        date: new Date().toISOString()
                    };
                    
                    // Get existing predictions from localStorage or initialize empty array
                    let savedPredictions = JSON.parse(localStorage.getItem('predictions') || '[]');
                    
                    // Add new prediction
                    savedPredictions.push(prediction);
                    
                    // Save to localStorage
                    localStorage.setItem('predictions', JSON.stringify(savedPredictions));
                    
                    // Show confirmation
                    alert('Prédiction sauvegardée avec succès!');
                });
            }
            
            // Apply styling to result badges
            const resultatBadges = document.querySelectorAll('.score-value');
            resultatBadges.forEach(badge => {
                const text = badge.textContent.trim();
                if (text === 'ADMIS(E)') {
                    badge.closest('.score-circle').style.background = 'linear-gradient(135deg, #28a745 0%, #218838 100%)';
                } else if (text === 'REFUSE(E)') {
                    badge.closest('.score-circle').style.background = 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)';
                } else if (text === 'LISTE ATTENTE') {
                    badge.closest('.score-circle').style.background = 'linear-gradient(135deg, #ffc107 0%, #e0a800 100%)';
                }
            });
        });
    </script>
</body>
</html>